/**
* jQuery ligerUI 1.3.3 | ligertree
*/
!function(a){function b(a){return a?a.replace(/(^\s*)|(\s*$)/g,""):a}a.fn.ligerTree=function(){return a.ligerui.run.call(this,"ligerTree",arguments)},a.fn.ligerGetTreeManager=function(){return a.ligerui.run.call(this,"ligerGetTreeManager",arguments)},a.ligerDefaults.Tree={url:null,urlParms:null,data:null,checkbox:!0,autoCheckboxEven:!0,enabledCompleteCheckbox:!0,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:!0,nodeWidth:90,statusName:"__status",isLeaf:null,single:!1,needCancel:!0,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:!0,iconFieldName:"icon",nodeDraggable:!1,nodeDraggingRender:null,btnClickToToggleOnly:!0,ajaxType:"post",ajaxContentType:null,render:null,selectable:null,isExpand:null,delay:null,idField:null,parentIDField:null,iconClsFieldName:null},a.ligerui.controls.Tree=function(b,c){a.ligerui.controls.Tree.base.constructor.call(this,b,c)},a.ligerui.controls.Tree.ligerExtend(a.ligerui.core.UIComponent,{_init:function(){a.ligerui.controls.Tree.base._init.call(this);var c=this.options;c.single&&(c.autoCheckboxEven=!1)},_render:function(){var b=this,c=this.options;b.set(c,!0),b.tree=a(b.element),b.tree.addClass("l-tree"),b.toggleNodeCallbacks=[],b.sysAttribute=["isexpand","ischecked","href","style","delay"],b.loading=a("<div class='l-tree-loading'></div>"),b.tree.after(b.loading),b.data=[],b.maxOutlineLevel=1,b.treedataindex=0,b._applyTree(),b._setTreeEven(),b.set(c,!1)},_setTreeLine:function(a){a?this.tree.removeClass("l-tree-noline"):this.tree.addClass("l-tree-noline")},_setParms:function(){var c=this.options;a.isFunction(c.parms)&&(c.parms=c.parms())},reload:function(a){var b=this,c=this.options;b.clear(),b.loadData(null,c.url,null,{success:a})},reloadNode:function(a,b,c){var d=this,e=this.options;if(d.clear(a),"string"==typeof b)d.loadData(a,b,null,{success:c});else{if(!b)return;e.idField&&e.parentIDField&&(b=d.arrayToTree(b,e.idField,e.parentIDField)),d.append(a,b)}},_setUrl:function(a){var b=this;this.options,a&&(b.clear(),b.loadData(null,a))},_setData:function(a){a&&(this.clear(),this.append(null,a))},setData:function(a){this.set("data",a)},getData:function(){return this.data},hasChildren:function(a){return this.options.isLeaf?!this.options.isLeaf(a):a.children?!0:!1},getParent:function(b,c){var e,f,d=this;return b=d.getNodeDom(b),(e=d.getParentTreeItem(b,c))?(f=a(e).attr("treedataindex"),d._getDataNodeByTreeDataIndex(d.data,f)):null},getParentTreeItem:function(b,c){var e,f,g,h,d=this;if(b=d.getNodeDom(b),e=a(b),e.parent().hasClass("l-tree"))return null;if(void 0==c)return 0==e.parent().parent("li").length?null:e.parent().parent("li")[0];for(f=parseInt(e.attr("outlinelevel")),g=e,h=f-1;h>=c;h--)g=g.parent().parent("li");return g[0]},getChecked:function(){var d,b=this;return this.options,this.options.checkbox?(d=[],a(".l-checkbox-checked",b.tree).parent().parent("li").each(function(){var c=parseInt(a(this).attr("treedataindex"));d.push({target:this,data:b._getDataNodeByTreeDataIndex(b.data,c)})}),d):null},getCheckedData:function(){var d,b=this;return this.options,this.options.checkbox?(d=[],a(".l-checkbox-checked",b.tree).parent().parent("li").each(function(){var c=parseInt(a(this).attr("treedataindex"));d.push(b._getDataNodeByTreeDataIndex(b.data,c))}),d):null},refreshTree:function(){var b=this;this.options,a.each(this.getChecked(),function(c,d){b._setParentCheckboxStatus(a(d.target))})},getSelected:function(){var d,e,b=this;return this.options,d={},d.target=a(".l-selected",b.tree).parent("li")[0],d.target?(e=parseInt(a(d.target).attr("treedataindex")),d.data=b._getDataNodeByTreeDataIndex(b.data,e),d):null},upgrade:function(b){var c=this;this.options,a(".l-note",b).each(function(){a(this).removeClass("l-note").addClass("l-expandable-open")}),a(".l-note-last",b).each(function(){a(this).removeClass("l-note-last").addClass("l-expandable-open")}),a("."+c._getChildNodeClassName(),b).each(function(){a(this).removeClass(c._getChildNodeClassName()).addClass(c._getParentNodeClassName(!0))})},demotion:function(b){var e,c=this;this.options,(b||"li"==b[0].tagName.toLowerCase())&&(e=a(b).hasClass("l-last"),a(".l-expandable-open",b).each(function(){a(this).removeClass("l-expandable-open").addClass(e?"l-note-last":"l-note")}),a(".l-expandable-close",b).each(function(){a(this).removeClass("l-expandable-close").addClass(e?"l-note-last":"l-note")}),a("."+c._getParentNodeClassName(!0),b).each(function(){a(this).removeClass(c._getParentNodeClassName(!0)).addClass(c._getChildNodeClassName())}))},collapseAll:function(){var b=this;this.options,a(".l-expandable-open",b.tree).click()},expandAll:function(){var b=this;this.options,a(".l-expandable-close",b.tree).click()},arrayToTree:function(a,b,c){function o(a){return"string"==typeof a&&(a=a.replace(/[.]/g,"").toLowerCase()),a}var f,g,h,i,j,k,l,m,n;if(this.options,f="children",!a||!a.length)return[];for(g=[],h={},i=a.length,j=0;i>j;j++)k=a[j],l=o(k[b]),h[l]=k;for(j=0;i>j;j++)m=a[j],l=o(m[c]),n=h[l],n?(n[f]=n[f]||[],n[f].push(m)):g.push(m);return g},loadData:function(b,c,d,e){var h,i,j,f=this,g=this.options;if(e=a.extend({showLoading:function(){f.loading.show()},success:function(){},error:function(){},hideLoading:function(){f.loading.hide()}},e||{}),h=g.ajaxType,d=a.extend(a.isFunction(g.parms)?g.parms():g.parms,d),"application/json"==g.ajaxContentType&&"string"!=typeof d&&(d=liger.toJSON(d)),i=a.isFunction(g.urlParms)?g.urlParms.call(f):g.urlParms)for(name in i)c+=-1==c.indexOf("?")?"?":"&",c+=name+"="+i[name];j={type:h,url:c,data:d,dataType:"json",beforeSend:function(){e.showLoading()},success:function(a){a&&(g.idField&&g.parentIDField&&(a=f.arrayToTree(a,g.idField,g.parentIDField)),e.hideLoading(),f.append(b,a),f.trigger("success",[a]),e.success(a))},error:function(a,b,c){try{d.hideLoading(),f.trigger("error",[a,b,c]),d.error(a,b,c)}catch(d){}}},g.ajaxContentType&&(j.contentType=g.ajaxContentType),a.ajax(j)},clear:function(b){var e,f,c=this;this.options,b?(e=c.getNodeDom(b),f=c._getDataNodeByTreeDataIndex(c.data,a(e).attr("treedataindex")),a(e).find("ul.l-children").remove(),f&&(f.children=[])):(c.toggleNodeCallbacks=[],c.data=null,c.data=[],c.nodes=null,c.tree.html(""))},getNodeDom:function(b){var c=this;return this.options,null==b?b:"string"==typeof b||"number"==typeof b?a("li[treedataindex="+b+"]",c.tree).get(0):"object"==typeof b&&"treedataindex"in b?c.getNodeDom(b["treedataindex"]):b.target&&b.data?b.target:b},hide:function(b){var c=this;this.options,b=c.getNodeDom(b),b&&a(b).hide()},show:function(b){var c=this;this.options,b=c.getNodeDom(b),b&&a(b).show()},remove:function(b){var e,f,g,c=this,d=this.options;b=c.getNodeDom(b),e=parseInt(a(b).attr("treedataindex")),f=c._getDataNodeByTreeDataIndex(c.data,e),f&&c._setTreeDataStatus([f],"delete"),g=c.getParentTreeItem(b),d.checkbox&&c._setParentCheckboxStatus(a(b)),a(b).remove(),c._updateStyle(g?a("ul:first",g):c.tree)},_updateStyle:function(b){var e,f,c=this;this.options,e=a(" > li",b),f=e.length,f&&e.each(function(b){0!=b||a(this).hasClass("l-first")||a(this).addClass("l-first"),b!=f-1||a(this).hasClass("l-last")||a(this).addClass("l-last"),0==b&&b==f-1&&a(this).addClass("l-onlychild"),a("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(b==f-1?"l-note-last":"l-note"),c._setTreeItem(this,{isLast:b==f-1})})},update:function(b,c){var f,g,d=this,e=this.options;b=d.getNodeDom(b),f=parseInt(a(b).attr("treedataindex")),nodedata=d._getDataNodeByTreeDataIndex(d.data,f);for(g in c)nodedata[g]=c[g],g==e.textFieldName&&a("> .l-body > span",b).text(c[g])},append:function(b,c,d,e){var h,i,j,k,l,m,n,f=this,g=this.options;if(b=f.getNodeDom(b),0==f.trigger("beforeAppend",[b,c]))return!1;if(!c||!c.length)return!1;if(g.idFieldName&&g.parentIDFieldName&&(c=f.arrayToTree(c,g.idFieldName,g.parentIDFieldName)),f._addTreeDataIndexToData(c),f._setTreeDataStatus(c,"add"),null!=d&&(d=f.getNodeDom(d)),f.trigger("append",[b,c]),f._appendData(b,c),null==b)return h=f._getTreeHTMLByData(c,1,[],!0),h[h.length-1]=h[0]="",null!=d?(a(d)[e?"after":"before"](h.join("")),f._updateStyle(b?a("ul:first",b):f.tree)):(a("> li:last",f.tree).length>0&&f._setTreeItem(a("> li:last",f.tree)[0],{isLast:!1}),f.tree.append(h.join(""))),a(".l-body",f.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f._upadteTreeWidth(),f.trigger("afterAppend",[b,c]),void 0;for(i=a(b),j=parseInt(i.attr("outlinelevel")),k=a("> ul",i).length>0,k||(i.append("<ul class='l-children'></ul>"),f.upgrade(b)),l=[],m=1;j-1>=m;m++)n=a(f.getParentTreeItem(b,m)),l.push(n.hasClass("l-last"));l.push(i.hasClass("l-last")),h=f._getTreeHTMLByData(c,j+1,l,!0),h[h.length-1]=h[0]="",null!=d?(a(d)[e?"after":"before"](h.join("")),f._updateStyle(b?a("ul:first",b):f.tree)):(a("> .l-children > li:last",i).length>0&&f._setTreeItem(a("> .l-children > li:last",i)[0],{isLast:!1}),a(">.l-children",b).append(h.join(""))),f._upadteTreeWidth(),a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f.trigger("afterAppend",[b,c])},cancelSelect:function(b,c){var d=this,e=this.options,f=d.getNodeDom(b),g=a(f),h=parseInt(g.attr("treedataindex")),i=d._getDataNodeByTreeDataIndex(d.data,h),j=a(">div:first",g);e.checkbox?a(".l-checkbox",j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"):j.removeClass("l-selected"),0!=c&&d.trigger("cancelSelect",[{data:i,target:g[0]}])},selectNode:function(c,d){var h,i,j,k,e=this,f=this.options,g=null;if("function"==typeof c)g=c;else{if("object"==typeof c)return h=a(c),i=parseInt(h.attr("treedataindex")),j=e._getDataNodeByTreeDataIndex(e.data,i),k=a(">div:first",h),k.length||(k=a("li[treedataindex="+i+"] >div:first",e.tree)),f.checkbox?a(".l-checkbox",k).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"):(a("div.l-selected",e.tree).removeClass("l-selected"),k.addClass("l-selected")),0!=d&&e.trigger("select",[{data:j,target:k.parent().get(0)}]),void 0;g=function(a){return a[f.idFieldName]||0==a[f.idFieldName]?b(a[f.idFieldName].toString())==b(c.toString()):!1}}a("li",e.tree).each(function(){var b=a(this),c=parseInt(b.attr("treedataindex")),f=e._getDataNodeByTreeDataIndex(e.data,c);g(f,c)?e.selectNode(this,d):e.options.checkbox||e.cancelSelect(this,d)})},getTextByID:function(a){var b=this,c=this.options,d=b.getDataByID(a);return d?d[c.textFieldName]:null},getDataByID:function(b){function f(a){var c,e,g;for(c=0;c<a.length;c++){if(e=a[c],e[d.idFieldName]==b)return e;if(e.children&&e.children.length&&(g=f(e.children)))return g}return null}var c=this,d=this.options,e=null;return c.data&&c.data.length?f(c.data):(a("li",c.tree).each(function(){var f,g,h;e||(f=a(this),g=parseInt(f.attr("treedataindex")),h=c._getDataNodeByTreeDataIndex(c.data,g),h[d.idFieldName].toString()==b.toString()&&(e=h))}),e)},arrayToTree:function(a,b,c){var d,e,f,g,h,i,j;if(!a||!a.length)return[];for(d=[],e={},f=a.length,g=0;f>g;g++)h=a[g],e[h[b]]=h;for(g=0;f>g;g++)i=a[g],j=e[i[c]],j?(j.children=j.children||[],j.children.push(i)):d.push(i);return d},_getDataNodeByTreeDataIndex:function(a,b){var e,f,c=this;for(this.options,e=0;e<a.length;e++){if(a[e].treedataindex==b)return a[e];if(a[e].children&&(f=c._getDataNodeByTreeDataIndex(a[e].children,b)))return f}return null},_setTreeDataStatus:function(b,c){var d=this,e=this.options;a(b).each(function(){this[e.statusName]=c,this.children&&d._setTreeDataStatus(this.children,c)})},_addTreeDataIndexToData:function(b){var c=this;this.options,a(b).each(function(){void 0==this.treedataindex&&(this.treedataindex=c.treedataindex++,this.children&&c._addTreeDataIndexToData(this.children))})},_addToNodes:function(b){var c=this;this.options,c.nodes=c.nodes||[],c.nodes.push(b),b.children&&a(b.children).each(function(a,b){c._addToNodes(b)})},_appendData:function(b,c){var f,g,d=this;this.options,f=parseInt(a(b).attr("treedataindex")),g=d._getDataNodeByTreeDataIndex(d.data,f),void 0==d.treedataindex&&(d.treedataindex=0),g&&void 0==g.children&&(g.children=[]),a(c).each(function(a,b){g?g.children[g.children.length]=b:d.data[d.data.length]=b,d._addToNodes(b)})},_setTreeItem:function(b,c){var f,g,d=this;this.options,c&&(b=d.getNodeDom(b),f=a(b),g=parseInt(f.attr("outlinelevel")),void 0!=c.isLast&&(1==c.isLast?(f.removeClass("l-last").addClass("l-last"),a("> div .l-note",f).removeClass("l-note").addClass("l-note-last"),a(".l-children li",f).find(".l-box:eq("+(g-1)+")").removeClass("l-line")):0==c.isLast&&(f.removeClass("l-last"),a("> div .l-note-last",f).removeClass("l-note-last").addClass("l-note"),a(".l-children li",f).find(".l-box:eq("+(g-1)+")").removeClass("l-line").addClass("l-line"))))},_upadteTreeWidth:function(){var a=this,b=this.options,c=22*a.maxOutlineLevel;b.checkbox&&(c+=22),(b.parentIcon||b.childIcon)&&(c+=22),c+=b.nodeWidth,a.tree.width(c)},_getChildNodeClassName:function(){var b=this.options;return"l-tree-icon-"+b.childIcon},_getParentNodeClassName:function(a){var c=this.options,d="l-tree-icon-"+c.parentIcon;return a&&(d+="-open"),d},_isExpand:function(a,b){var d=this.options,e=null!=a.isExpand?a.isExpand:null!=a.isexpand?a.isexpand:d.isExpand;return null==e?!0:("function"==typeof e&&(e=d.isExpand({data:a,level:b})),"boolean"==typeof e?e:"string"==typeof e?"true"==e:"number"==typeof e?e>b:!0)},_getDelay:function(b,c){var e=this.options,f=null!=b.delay?b.delay:e.delay;return null==f?!1:("function"==typeof f&&(f=f({data:b,level:c})),"boolean"==typeof f?f:"string"==typeof f?{url:f}:("number"==typeof f&&(f=[f]),a.isArray(f)?-1!=a.inArray(c,f):"object"==typeof f&&f.url?f:!1))},_getTreeHTMLByData:function(b,c,d,e){var h,i,j,k,l,m,n,o,p,q,f=this,g=this.options;for(f.maxOutlineLevel<c&&(f.maxOutlineLevel=c),d=d||[],c=c||1,h=[],e?h.push("<ul class='l-children'>"):h.push('<ul class="l-children" style="display:none">'),i=0;i<b.length;i++){for(j=b[i],k=0==i,l=i==b.length-1,m=f._getDelay(j,c),n=m?!1:f._isExpand(j,c),h.push("<li "),void 0!=j.treedataindex&&h.push('treedataindex="'+j.treedataindex+'" '),n&&h.push("isexpand="+j.isexpand+" "),h.push("outlinelevel="+c+" "),o=0;o<f.sysAttribute.length;o++)a(this).attr(f.sysAttribute[o])&&(b[dataindex][f.sysAttribute[o]]=a(this).attr(f.sysAttribute[o]));for(o=0;o<g.attribute.length;o++)j[g.attribute[o]]&&h.push(g.attribute[o]+'="'+j[g.attribute[o]]+'" ');for(h.push('class="'),k&&h.push("l-first "),l&&h.push("l-last "),k&&l&&h.push("l-onlychild "),h.push('"'),h.push(">"),h.push('<div class="l-body'),g.selectable&&0==g.selectable(j)&&h.push(" l-unselectable"),h.push('">'),p=0;c-2>=p;p++)d[p]?h.push('<div class="l-box"></div>'):h.push('<div class="l-box l-line"></div>');if(f.hasChildren(j)?(n?h.push('<div class="l-box l-expandable-open"></div>'):h.push('<div class="l-box l-expandable-close"></div>'),g.checkbox&&(j.ischecked?h.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):h.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),g.parentIcon&&(h.push('<div class="l-box l-tree-icon '),h.push(f._getParentNodeClassName(n?!0:!1)+" "),g.iconFieldName&&j[g.iconFieldName]?h.push("l-tree-icon-none"):g.iconClsFieldName&&j[g.iconClsFieldName]&&h.push("l-tree-icon-"+j[g.iconClsFieldName]+" "),h.push('">'),g.iconFieldName&&j[g.iconFieldName]&&h.push('<img src="'+j[g.iconFieldName]+'" />'),h.push("</div>"))):(l?h.push('<div class="l-box l-note-last"></div>'):h.push('<div class="l-box l-note"></div>'),g.checkbox&&(j.ischecked?h.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):h.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),g.childIcon&&(h.push('<div class="l-box l-tree-icon '),h.push(f._getChildNodeClassName()+" "),g.iconFieldName&&j[g.iconFieldName]?h.push("l-tree-icon-none"):g.iconClsFieldName&&j[g.iconClsFieldName]&&h.push("l-tree-icon-"+j[g.iconClsFieldName]+" "),h.push('">'),g.iconFieldName&&j[g.iconFieldName]&&h.push('<img src="'+j[g.iconFieldName]+'" />'),h.push("</div>"))),g.render?h.push("<span>"+g.render(j,j[g.textFieldName])+"</span>"):h.push("<span>"+j[g.textFieldName]+"</span>"),h.push("</div>"),f.hasChildren(j)){for(q=[],p=0;p<d.length;p++)q.push(d[p]);q.push(l),m?1==m?f.toggleNodeCallbacks.push({data:j,callback:function(b,d){var e=f._getTreeHTMLByData(d.children,c+1,q,n).join("");a(b).append(e),a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),f._removeToggleNodeCallback(d)}}):m.url&&function(b,c,d){f.toggleNodeCallbacks.push({data:b,callback:function(b,e){f.loadData(b,c,d,{showLoading:function(){a("div.l-expandable-close:first",b).addClass("l-box-loading")},hideLoading:function(){a("div.l-box-loading:first",b).removeClass("l-box-loading")}}),f._removeToggleNodeCallback(e)}})}(j,m.url,m.parms):h.push(f._getTreeHTMLByData(j.children,c+1,q,n).join(""))}h.push("</li>")}return h.push("</ul>"),h},_removeToggleNodeCallback:function(a){var d,b=this;for(this.options,d=0;d<=b.toggleNodeCallbacks.length;d++)if(b.toggleNodeCallbacks[d]&&b.toggleNodeCallbacks[d].data==a){b.toggleNodeCallbacks.splice(d,1);break}},_getDataByTreeHTML:function(b){var c=this,d=this.options,e=[];return a("> li",b).each(function(){var h,g=e.length;for(e[g]={treedataindex:c.treedataindex++},e[g][d.textFieldName]=a("> span,> a",this).html(),h=0;h<c.sysAttribute.length;h++)a(this).attr(c.sysAttribute[h])&&(e[g][c.sysAttribute[h]]=a(this).attr(c.sysAttribute[h]));for(h=0;h<d.attribute.length;h++)a(this).attr(d.attribute[h])&&(e[g][d.attribute[h]]=a(this).attr(d.attribute[h]));a("> ul",this).length>0&&(e[g].children=c._getDataByTreeHTML(a("> ul",this)))}),e},_applyTree:function(){var d,b=this;this.options,b.data=b._getDataByTreeHTML(b.tree),d=b._getTreeHTMLByData(b.data,1,[],!0),d[d.length-1]=d[0]="",b.tree.html(d.join("")),b._upadteTreeWidth(),a(".l-body",b.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(b){var h,i,c=this,d=b.target||b.srcElement,e=d.tagName.toLowerCase(),f=a(d).parents().add(d),g=function(b){for(var c=f.length-1;c>=0;c--)if(a(f[c]).hasClass(b))return f[c];return null};return-1==f.index(this.element)?{out:!0}:(h={tree:g("l-tree"),node:g("l-body"),checkbox:g("l-checkbox"),icon:g("l-tree-icon"),text:"span"==e},h.node&&(i=parseInt(a(h.node).parent().attr("treedataindex")),h.data=c._getDataNodeByTreeDataIndex(c.data,i)),h)},_setTreeEven:function(){var b=this,c=this.options;b.hasBind("contextmenu")&&b.tree.bind("contextmenu",function(c){var f,g,d=c.target||c.srcElement,e=null;return"a"==d.tagName.toLowerCase()||"span"==d.tagName.toLowerCase()||a(d).hasClass("l-box")?e=a(d).parent().parent():a(d).hasClass("l-body")?e=a(d).parent():"li"==d.tagName.toLowerCase()&&(e=a(d)),e?(f=parseInt(e.attr("treedataindex")),g=b._getDataNodeByTreeDataIndex(b.data,f),b.trigger("contextmenu",[{data:g,target:e[0]},c])):void 0}),b.tree.click(function(d){var g,h,i,j,k,e=d.target||d.srcElement,f=null;if(f="a"==e.tagName.toLowerCase()||"span"==e.tagName.toLowerCase()||a(e).hasClass("l-box")?a(e).parent().parent():a(e).hasClass("l-body")?a(e).parent():a(e)){if(g=parseInt(f.attr("treedataindex")),h=b._getDataNodeByTreeDataIndex(b.data,g),i=a("div.l-body:first",f).find("div.l-expandable-open:first,div.l-expandable-close:first"),j=a(e).hasClass("l-expandable-open")||a(e).hasClass("l-expandable-close"),!a(e).hasClass("l-checkbox")&&!j&&!f.hasClass("l-unselectable"))if(a(">div:first",f).hasClass("l-selected")&&c.needCancel){if(0==b.trigger("beforeCancelSelect",[{data:h,target:f[0]}]))return!1;a(">div:first",f).removeClass("l-selected"),b.trigger("cancelSelect",[{data:h,target:f[0]}])}else{if(0==b.trigger("beforeSelect",[{data:h,target:f[0]}]))return!1;a(".l-body",b.tree).removeClass("l-selected"),a(">div:first",f).addClass("l-selected"),b.trigger("select",[{data:h,target:f[0]}])}if(a(e).hasClass("l-checkbox"))c.autoCheckboxEven?(a(e).hasClass("l-checkbox-unchecked")?(a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:h,target:f[0]},!0])):a(e).hasClass("l-checkbox-checked")?(a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!1])):a(e).hasClass("l-checkbox-incomplete")&&(a(e).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",f).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:h,target:f[0]},!0])),b._setParentCheckboxStatus(f)):a(e).hasClass("l-checkbox-unchecked")?(a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),c.single&&a(".l-checkbox",b.tree).not(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!0])):a(e).hasClass("l-checkbox-checked")&&(a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:h,target:f[0]},!1]));else if(!i.hasClass("l-expandable-open")||c.btnClickToToggleOnly&&!j){if(i.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||j)){if(0==b.trigger("beforeExpand",[{data:h,target:f[0]}]))return!1;a(b.toggleNodeCallbacks).each(function(){this.data==h&&this.callback(f[0],h)}),i.removeClass("l-expandable-close").addClass("l-expandable-open"),k=function(){b.trigger("expand",[{data:h,target:f[0]}])},c.slide?a("> .l-children",f).slideToggle("fast",k):(a("> .l-children",f).show(),k()),a("> div ."+b._getParentNodeClassName(),f).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(!0))}}else{if(0==b.trigger("beforeCollapse",[{data:h,target:f[0]}]))return!1;i.removeClass("l-expandable-open").addClass("l-expandable-close"),c.slide?a("> .l-children",f).slideToggle("fast"):a("> .l-children",f).hide(),a("> div ."+b._getParentNodeClassName(!0),f).removeClass(b._getParentNodeClassName(!0)).addClass(b._getParentNodeClassName()),b.trigger("collapse",[{data:h,target:f[0]}])}b.trigger("click",[{data:h,target:f[0]}])}}),a.fn.ligerDrag&&c.nodeDraggable&&(b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body"),b.tree.ligerDrag({revert:!0,animate:!1,proxyX:20,proxyY:20,proxy:function(d,e){var g,h,i,j,k,f=b._getSrcElementByEvent(e);if(f.node){if(g="dragging",c.nodeDraggingRender)g=c.nodeDraggingRender(d.draggingNodes,d,b);else{g="",h=!1;for(i in d.draggingNodes)j=d.draggingNodes[i],h&&(g+=","),g+=j.text,h=!0}return k=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+g+"</div>").appendTo("body")}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),b.children[this.id]=this},onStartDrag:function(a,d){var e,f,g;if(2==d.button)return!1;if(this.set("cursor","default"),e=b._getSrcElementByEvent(d),e.checkbox)return!1;if(c.checkbox){f=b.getChecked(),this.draggingNodes=[];for(g in f)this.draggingNodes.push(f[g].data);if(!this.draggingNodes||!this.draggingNodes.length)return!1}else this.draggingNodes=[e.data];this.draggingNode=e.data,this.set("cursor","move"),b.nodedragging=!0,this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,e=this.draggingNode;if(!e)return!1;if(f=this.draggingNodes?this.draggingNodes:[e],null==b.nodeDropIn&&(b.nodeDropIn=-1),g=d.pageX,h=d.pageY,i=!1,j=this.validRange,g<j.left||g>j.right||h>j.bottom||h<j.top)return b.nodeDropIn=-1,b.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no"),void 0;for(k=0,l=b.nodes.length;l>k;k++)if(m=b.nodes[k],n=m["treedataindex"],e["treedataindex"]==n&&(i=!0),-1==a.inArray(m,f)&&(o=i?!0:!1,-1==b.nodeDropIn||b.nodeDropIn==n)){if(p=a("li[treedataindex="+n+"] div:first",b.tree),q=p.offset(),r={top:q.top,bottom:q.top+p.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()},g>r.left&&g<r.right&&h>r.top&&h<r.bottom){s=q.top,o&&(s+=p.height()),b.nodeDroptip.css({left:r.left,top:s,width:r.right-r.left}).show(),b.nodeDropIn=n,b.nodeDropDir=o?"bottom":"top",h>r.top+7&&h<r.bottom-7?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),b.nodeDroptip.hide(),b.nodeDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),b.nodeDroptip.show(),b.nodeDropInParent=!1);break}-1!=b.nodeDropIn&&(b.nodeDropIn=-1,b.nodeDropInParent=!1,b.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}},onStopDrag:function(){var f,g,h,e=this.draggingNodes;if(b.nodedragging=!1,-1!=b.nodeDropIn){for(f=0;f<e.length;f++)g=e[f].children,g&&(e=a.grep(e,function(b){var d=-1==a.inArray(b,g);return d}));for(f in e)h=e[f],b.nodeDropInParent?(b.remove(h),b.append(b.nodeDropIn,[h])):(b.remove(h),b.append(b.getParent(b.nodeDropIn),[h],b.nodeDropIn,"bottom"==b.nodeDropDir));b.nodeDropIn=-1}b.nodeDroptip.hide(),this.set("cursor","default")}}))},_setParentCheckboxStatus:function(b){var c=this,d=this.options,e=0==a(".l-checkbox-unchecked",b.parent()).length,f=0==a(".l-checkbox-checked",b.parent()).length;f?b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked"):e||!d.enabledCompleteCheckbox?b.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked"):b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete"),b.parent().parent("li").length>0&&c._setParentCheckboxStatus(b.parent().parent("li"))}})}(jQuery);
